$.extend({log:function(e){var t=new Date,o=t.getFullYear(),i=t.getMonth()+1,h=t.getDate(),a=t.getHours(),p=t.getMinutes(),s=t.getSeconds(),d=o+"/"+i+"/"+h+" "+a+":"+p+":"+s;console.log(d+" My App: "+e)}}),function(e,t,o){e.jCrop=function(e){function i(e,i,p){y=t("#"+e),y.attr("src",i),p!=o&&(k=p,H.previewEnable=!0,c(k),D.hide()),z=t("<div>").appendTo("body").attr("id","mask_box").addClass("default-mask-box").css(H.maskCSS),z.css("cursor",T.crosshair),y.css("cursor",T.crosshair),y.mousedown(h),z.mousedown(h),t(window).mousemove(a),t(window).mouseup(d)}function h(e){return H.maskEnable?(z.css({left:y.position().left,top:y.position().top,width:y.width(),height:y.height()}).css("zIndex",5),z.show()):z.hide(),D!=o&&D.hide(),H.previewEnable?D.show():D.hide(),C!=o&&(C.remove(),C=null),E=!0,e.preventDefault(),E=!0,mouseDown_left=e.pageX,mouseDown_top=e.pageY,R.left=mouseDown_left,R.width=0,R.top=mouseDown_top,R.height=0,!1}function a(e){if(E){R.left=mouseDown_left<e.pageX?mouseDown_left:e.pageX,R.width=Math.abs(mouseDown_left-e.pageX),R.top=mouseDown_top<e.pageY?mouseDown_top:e.pageY,R.height=Math.abs(mouseDown_top-e.pageY);var t=g(R.width,R.height,H.whRatio);R.width=t.w,R.height=t.h,p(R),r(),l()}else if(_){switch(I){case T.m:A.left=R.left+(e.pageX-j.x),A.top=R.top+(e.pageY-j.y),A.width=R.width,A.height=R.height;break;case T.l:A.left=e.pageX>R.left+R.width?R.left+R.width:e.pageX,A.top=R.top,A.width=Math.abs(e.pageX-(R.left+R.width)),A.height=R.height;break;case T.r:A.left=e.pageX>R.left?R.left:e.pageX,A.top=R.top,A.width=Math.abs(e.pageX-R.left),A.height=R.height;break;case T.u:A.left=R.left,A.top=e.pageY>R.top+R.height?R.top+R.height:e.pageY,A.width=R.width,A.height=Math.abs(e.pageY-(R.top+R.height));break;case T.d:A.left=R.left,A.top=e.pageY>R.top?R.top:e.pageY,A.width=R.width,A.height=Math.abs(e.pageY-R.top);break;case T.lu:A.left=e.pageX>R.left+R.width?R.left+R.width:e.pageX,A.top=e.pageY>R.top+R.height?R.top+R.height:e.pageY,A.width=Math.abs(e.pageX-(R.left+R.width)),A.height=Math.abs(e.pageY-(R.top+R.height));break;case T.ld:A.left=e.pageX>R.left+R.width?R.left+R.width:e.pageX,A.top=e.pageY>R.top?R.top:e.pageY,A.width=Math.abs(e.pageX-(R.left+R.width)),A.height=Math.abs(e.pageY-R.top);break;case T.ru:A.left=e.pageX>R.left?R.left:e.pageX,A.top=e.pageY>R.top+R.height?R.top+R.height:e.pageY,A.width=Math.abs(e.pageX-R.left),A.height=Math.abs(e.pageY-(R.top+R.height));break;case T.rd:A.left=e.pageX>R.left?R.left:e.pageX,A.top=e.pageY>R.top?R.top:e.pageY,A.width=Math.abs(e.pageX-R.left),A.height=Math.abs(e.pageY-R.top)}p(A),r(),l()}else u({x:e.pageX,y:e.pageY},R);if(C){var o=y.offset();F={left:C.offset().left-o.left,top:C.offset().top-o.top,width:C.width(),height:C.height()}}else F={left:0,top:0,width:0,height:0}}function p(e){var t={left:y.position().left,top:y.position().top,width:y.width(),height:y.height()};e.left>t.left?(e.left+e.width>t.left+t.width&&(e.width=t.left+t.width-e.left),e.left>t.left+t.width&&(e.left=t.left+t.width,e.width=0)):(e.width=e.width-(t.left-e.left),e.left=t.left),e.top>t.top?(e.top+e.height>t.top+t.height&&(e.height=t.top+t.height-e.top),e.top>t.top+t.height&&(e.top=t.top+t.height,e.height=0)):(e.height=e.height-(t.top-e.top),e.top=t.top)}function s(e){return e.preventDefault(),H.dragEnable&&(_=!0,j.x=e.pageX,j.y=e.pageY),!1}function d(e){E&&(E=!1,C&&0!=C.width()&&0!=C.height()||(z.hide(),D.hide(),C&&(C.remove(),C=null),clearInterval(M))),_&&(_=!1,R.left=A.left,R.top=A.top,R.width=A.width,R.height=A.height,u({x:e.pageX,y:e.pageY},R)),f(C)}function r(){var e,o;C&&C.remove(),C=t("<div>").appendTo("body").attr("id","drag_box").addClass("default-drag-box dashed-box").css(H.dragBoxCSS),C.mousemove(a),C.mousedown(s),E&&(e=g(R.width,R.height,H.whRatio),R.width=e.w,R.height=e.h,o=R),_&&(e=g(A.width,A.height,H.whRatio),A.width=e.w,A.height=e.h,o=A),C.css({left:o.left,top:o.top,width:o.width,height:o.height}).css("zIndex",10),f(C)}function l(){if(H.previewEnable){zoom=1,w(),H.fixRatio&&(E&&(zoom=R.width/D.width()),_&&(zoom=A.width/D.width()));var e=y.width()/zoom,t=y.height()/zoom,o=y.position().left,i=y.position().top,h=C.position().left,a=C.position().top,p=(o-h)/zoom,s=(i-a)/zoom;S.css({width:e,height:t,marginLeft:p,marginTop:s})}}function n(e,o){t("<div>").appendTo("body").addClass("corner-box").css({left:e-2,top:o-1})}function f(e){if(t(".corner-box").remove(),e)return H.dragEnable&&(n(e.position().left-H.border/2,e.position().top-H.border/2),n(e.position().left+e.width()/2-H.border/2,e.position().top-H.border/2),n(e.position().left+e.width()-H.border/2,e.position().top-H.border/2),n(e.position().left-H.border/2,e.position().top+e.height()/2-H.border/2),n(e.position().left+e.width()-H.border/2,e.position().top+e.height()/2-H.border/2),n(e.position().left-H.border/2,e.position().top+e.height()-H.border),n(e.position().left+e.width()/2-H.border/2,e.position().top+e.height()-H.border),n(e.position().left+e.width()-H.border/2,e.position().top+e.height()-H.border)),H.flowEnable?void(e.hasClass("dashed-box")&&(e.removeClass("dashed-box"),t("<div>").appendTo(e).addClass("dashed-top").css("top",0),t("<div>").appendTo(e).addClass("dashed-left").css("left",0),t("<div>").appendTo(e).addClass("dashed-bottom").css("top",e.height()-2),t("<div>").appendTo(e).addClass("dashed-right").css("left",e.width()-2),clearInterval(M),M=setInterval(function(){var e=t(".dashed-top").css("left"),o=t(".dashed-bottom").css("left");e=parseInt(e),o=parseInt(o),e<0?e+=2:e=-1400,o>-1e3?o-=2:o=0,t(".dashed-top").css("left",e+"px"),t(".dashed-right").css("top",e+"px"),t(".dashed-bottom").css("left",o+"px"),t(".dashed-left").css("top",o+"px")},60))):(clearInterval(M),e.addClass("dashed-box"),t(".dashed-top").remove(),t(".dashed-left").remove(),t(".dashed-bottom").remove(),void t(".dashed-right").remove())}function g(e,t,o){var i=e,h=t;return H.fixRatio&&(o=o instanceof Array?2==o.length?parseFloat(o[0])/(parseFloat(o[1])||1)||1:parseFloat(o[0])||1:parseFloat(o)||1,e/t<o?(i=t*o,h=t):(h=e/o,i=e)),{w:i,h:h}}function w(e,t,o){if(k){e="undefined"!=typeof e?e:H.previewCSS.width,t="undefined"!=typeof t?t:H.previewCSS.height,o="undefined"!=typeof o?o:H.whRatio,o=o instanceof Array?2==o.length?parseFloat(o[0])/(parseFloat(o[1])||1)||1:parseFloat(o[0])||1:parseFloat(o)||1;var i=e,h=t;o>=1?(h=e/o,i=e):(i=t*o,h=t),D.css({width:i,height:h})}}function c(e){k=e,D=t("#"+k).addClass("default-preview-box").css(H.previewCSS),w(),S=t("<img>").appendTo("#"+k).attr("id","preview_box").attr("src",image),H.previewEnable||D.hide()}function u(e,t){if(!_&&C){var o=H.border,i=[t.left,t.top,t.left+t.width,t.top+t.height];I=T.crosshair,b(e.x,i[0]+o,i[2]-o)&&b(e.y,i[1]+o,i[3]-o)&&(I=H.dragEnable?T.m:T["default"]),H.dragEnable&&(b(e.x,i[0],i[0]+o)&&b(e.y,i[1]+o,i[3]-o)&&(I=T.l),b(e.x,i[2],i[2]-o)&&b(e.y,i[1]+o,i[3]-o)&&(I=T.r),b(e.x,i[2]-o,i[0]+o)&&b(e.y,i[1],i[1]+o)&&(I=T.u),b(e.x,i[2]-o,i[0]+o)&&b(e.y,i[3],i[3]-o)&&(I=T.d),b(e.x,i[0],i[0]+o)&&b(e.y,i[1],i[1]+o)&&(I=T.lu),b(e.x,i[0],i[0]+o)&&b(e.y,i[3],i[3]-o)&&(I=T.ld),b(e.x,i[2],i[2]-o)&&b(e.y,i[1],i[1]+o)&&(I=T.ru),b(e.x,i[2],i[2]-o)&&b(e.y,i[3],i[3]-o)&&(I=T.rd)),C.css("cursor",I),y.css("cursor",I),z.css("cursor",I)}}function b(e,t,o){return e<=t&&e>=o||e<=o&&e>=t}function m(){}function v(){m()}function x(){C.remove(),z.remove(),C=null,z=null}function Y(){return F}function X(){x()}var y,C,z,M,S,D,k=null,E=!1,_=!1,F={left:0,top:0,width:0,height:0},R={left:0,width:0,top:0,height:0},T={"default":"auto",crosshair:"crosshair",m:"move",l:"w-resize",r:"e-resize",u:"n-resize",d:"s-resize",lu:"nw-resize",ld:"sw-resize",ru:"ne-resize",rd:"se-resize"},I=T["default"],A={},j={},B={color:{red:"#ff0000",blue:"#0000ff",green:"#00ff00",gray:"#eeeeee"},opacity:{no:0,low:.2,mid:.5,high:.8,full:1}},P={dragBoxCSS:{},maskEnable:!0,maskCSS:{},dragEnable:!0,previewEnable:!0,previewCSS:{width:200,height:200},fixRatio:!1,whRatio:[2,1],flowEnable:!0,border:5,api:{}},H=t.extend({},P,e);return{init:i,initPreview:c,config:H,option:B,setPreDivRect:w,crop:Y,cancel:X,refresh:v}}()}(this,jQuery);